import { AnyEventResponse, ClickEventRequest, ClickEventResponse, CustomEventRequest, CustomEventResponse, EventType, HealthResponse, SearchEventRequest, SearchEventResponse, ViewEventRequest, ViewEventResponse, VisitResponse, VariableArgumentsPayload, PreparedClickEventRequest, PreparedCustomEventRequest, PreparedViewEventRequest, PreparedSearchEventRequest } from '../events';
import { PreprocessAnalyticsRequest, VisitorIdProvider } from './analyticsRequestClient';
import { IRuntimeEnvironment } from './runtimeEnvironment';
export declare const Version = "v15";
export declare const Endpoints: {
    default: string;
    production: string;
    hipaa: string;
};
export interface ClientOptions {
    token?: string;
    endpoint: string;
    isCustomEndpoint?: boolean;
    version: string;
    runtimeEnvironment?: IRuntimeEnvironment;
    beforeSendHooks: AnalyticsClientSendEventHook[];
    afterSendHooks: AnalyticsClientSendEventHook[];
    preprocessRequest?: PreprocessAnalyticsRequest;
}
export type AnalyticsClientSendEventHook = <TResult>(eventType: string, payload: any) => TResult | Promise<TResult>;
export type EventTypeConfig = {
    newEventType: EventType;
    variableLengthArgumentsNames?: string[];
    addVisitorIdParameter?: boolean;
    addClientIdParameter?: boolean;
    usesMeasurementProtocol?: boolean;
};
export interface PreparedEvent<TPreparedRequest, TCompleteRequest, TResponse extends AnyEventResponse> extends BufferedRequest {
    log(remainingPayload: Omit<TCompleteRequest, keyof TPreparedRequest>): Promise<TResponse | void>;
}
export interface AnalyticsClient {
    getPayload(eventType: string, ...payload: VariableArgumentsPayload): Promise<any>;
    getParameters(eventType: string, ...payload: VariableArgumentsPayload): Promise<any>;
    makeEvent<TPreparedRequest, TCompleteRequest, TResponse extends AnyEventResponse>(eventType: string, ...payload: VariableArgumentsPayload): Promise<PreparedEvent<TPreparedRequest, TCompleteRequest, TResponse>>;
    sendEvent(eventType: string, ...payload: VariableArgumentsPayload): Promise<AnyEventResponse | void>;
    makeSearchEvent(request: PreparedSearchEventRequest): Promise<PreparedEvent<PreparedSearchEventRequest, SearchEventRequest, SearchEventResponse>>;
    sendSearchEvent(request: SearchEventRequest): Promise<SearchEventResponse | void>;
    makeClickEvent(request: PreparedClickEventRequest): Promise<PreparedEvent<PreparedClickEventRequest, ClickEventRequest, ClickEventResponse>>;
    sendClickEvent(request: ClickEventRequest): Promise<ClickEventResponse | void>;
    makeCustomEvent(request: PreparedCustomEventRequest): Promise<PreparedEvent<PreparedCustomEventRequest, CustomEventRequest, CustomEventResponse>>;
    sendCustomEvent(request: CustomEventRequest): Promise<CustomEventResponse | void>;
    makeViewEvent(request: PreparedViewEventRequest): Promise<PreparedEvent<PreparedViewEventRequest, ViewEventRequest, ViewEventResponse>>;
    sendViewEvent(request: ViewEventRequest): Promise<ViewEventResponse | void>;
    getVisit(): Promise<VisitResponse>;
    getHealth(): Promise<HealthResponse>;
    registerBeforeSendEventHook(hook: AnalyticsClientSendEventHook): void;
    registerAfterSendEventHook(hook: AnalyticsClientSendEventHook): void;
    addEventTypeMapping(eventType: string, eventConfig: EventTypeConfig): void;
    runtime: IRuntimeEnvironment;
    version: string;
    readonly currentVisitorId: string;
    getCurrentVisitorId?(): Promise<string>;
    setAcceptedLinkReferrers?(hosts: string[]): void;
}
export interface BufferedRequest {
    eventType: EventType;
    payload: any;
}
export declare function buildBaseUrl(endpoint?: string, apiVersion?: string, isCustomEndpoint?: boolean): string;
export declare class CoveoAnalyticsClient implements AnalyticsClient, VisitorIdProvider {
    private get defaultOptions();
    runtime: IRuntimeEnvironment;
    get version(): string;
    private visitorId;
    private bufferedRequests;
    private beforeSendHooks;
    private afterSendHooks;
    private eventTypeMapping;
    private options;
    private acceptedLinkReferrers;
    constructor(opts: Partial<ClientOptions>);
    private initRuntime;
    private get storage();
    private determineVisitorId;
    getCurrentVisitorId(): Promise<string>;
    setCurrentVisitorId(visitorId: string): Promise<void>;
    setClientId(value: string, namespace?: string): Promise<void>;
    getParameters(eventType: EventType | string, ...payload: VariableArgumentsPayload): Promise<any>;
    getPayload(eventType: EventType | string, ...payload: VariableArgumentsPayload): Promise<any>;
    get currentVisitorId(): string;
    set currentVisitorId(visitorId: string);
    private extractClientIdFromLink;
    resolveParameters(eventType: EventType | string, ...payload: VariableArgumentsPayload): Promise<any>;
    resolvePayloadForParameters(eventType: EventType | string, parameters: any): Promise<any>;
    makeEvent<TPreparedRequest, TCompleteRequest, TResponse extends AnyEventResponse>(eventType: EventType | string, ...payload: VariableArgumentsPayload): Promise<PreparedEvent<TPreparedRequest, TCompleteRequest, TResponse>>;
    sendEvent(eventType: EventType | string, ...payload: VariableArgumentsPayload): Promise<void | AnyEventResponse>;
    private deferExecution;
    private sendFromBuffer;
    clear(): void;
    deleteHttpOnlyVisitorId(): void;
    makeSearchEvent(request: PreparedSearchEventRequest): Promise<PreparedEvent<PreparedSearchEventRequest, SearchEventRequest, SearchEventResponse>>;
    sendSearchEvent({ searchQueryUid, ...preparedRequest }: SearchEventRequest): Promise<void | SearchEventResponse>;
    makeClickEvent(request: PreparedClickEventRequest): Promise<PreparedEvent<PreparedClickEventRequest, ClickEventRequest, ClickEventResponse>>;
    sendClickEvent({ searchQueryUid, ...preparedRequest }: ClickEventRequest): Promise<void | ClickEventResponse>;
    makeCustomEvent(request: PreparedCustomEventRequest): Promise<PreparedEvent<PreparedCustomEventRequest, CustomEventRequest, CustomEventResponse>>;
    sendCustomEvent({ lastSearchQueryUid, ...preparedRequest }: CustomEventRequest): Promise<void | CustomEventResponse>;
    makeViewEvent(request: PreparedViewEventRequest): Promise<PreparedEvent<PreparedViewEventRequest, ViewEventRequest, ViewEventResponse>>;
    sendViewEvent(request: ViewEventRequest): Promise<ViewEventResponse | void>;
    getVisit(): Promise<VisitResponse>;
    getHealth(): Promise<HealthResponse>;
    registerBeforeSendEventHook(hook: AnalyticsClientSendEventHook): void;
    registerAfterSendEventHook(hook: AnalyticsClientSendEventHook): void;
    addEventTypeMapping(eventType: string, eventConfig: EventTypeConfig): void;
    setAcceptedLinkReferrers(hosts: string[]): void;
    private parseVariableArgumentsPayload;
    private isKeyAllowedEmpty;
    private removeEmptyPayloadValues;
    private removeUnknownParameters;
    private processCustomParameters;
    private mapCustomParametersToCustomData;
    private lowercaseKeys;
    private validateParams;
    private ensureAnonymousUserWhenUsingApiKey;
    private setTrackingIdIfTrackingIdNotPresent;
    private limit;
    private get baseUrl();
}
export default CoveoAnalyticsClient;
