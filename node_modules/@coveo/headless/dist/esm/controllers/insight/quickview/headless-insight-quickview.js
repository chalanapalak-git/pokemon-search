import { configuration } from '../../../app/common-reducers.js';
import { insightInterfaceReducer as insightInterface } from '../../../features/insight-interface/insight-interface-slice.js';
import { buildInsightResultPreviewRequest, } from '../../../features/insight-search/insight-result-preview-request-builder.js';
import { logDocumentQuickview } from '../../../features/result-preview/result-preview-insight-analytics-actions.js';
import { resultPreviewReducer as resultPreview } from '../../../features/result-preview/result-preview-slice.js';
import { loadReducerError } from '../../../utils/errors.js';
import { buildCoreQuickview } from '../../core/quickview/headless-core-quickview.js';
/**
 * Creates an insight `Quickview` controller instance.
 * @param engine - The insight engine.
 * @param props - The configurable `Quickview` properties.
 * @returns A `Quickview` controller instance.
 *
 * @group Controllers
 * @category Quickview
 */
export function buildQuickview(engine, props) {
    if (!loadQuickviewReducers(engine)) {
        throw loadReducerError;
    }
    const fetchResultContentCallback = () => {
        engine.dispatch(logDocumentQuickview(props.options.result));
    };
    const path = '/quickview';
    const coreProps = {
        options: {
            ...props.options,
            onlyContentURL: true,
        },
    };
    return buildCoreQuickview(engine, coreProps, (state, options) => buildInsightResultPreviewRequest(state, options), path, fetchResultContentCallback);
}
function loadQuickviewReducers(engine) {
    engine.addReducers({ configuration, resultPreview, insightInterface });
    return true;
}
